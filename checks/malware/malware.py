#!/usr/bin/python3
import json
import requests
import sys
import socket
results=[]

def main(type:str,domain:str):

        if type=="domain":
            host_name = domain

        elif type=="ip":
            host_name = socket.gethostbyaddr(domain)[0]
            print (host_name)

        response = requests.get("https://sitecheck.sucuri.net/api/v3/?scan="+host_name)
        scanresult='ratings'
        ratingscore='rating'

        A=10
        B=5
        C=0


        responsedr=json.loads(response.text)
        tlsscore=responsedr[scanresult]['tls'][ratingscore]
        totalscore=responsedr[scanresult]['total'][ratingscore]
        domainscore=responsedr[scanresult]['domain'][ratingscore]
        securityscore=responsedr[scanresult]['security'][ratingscore]

        scorelistletter=[tlsscore,totalscore,domainscore,securityscore]
        Scorenumber=[]
        for i in scorelistletter:
            if i == "A":
               Scorenumber.append(A)
            if i == "B":
                Scorenumber.append(B)
            if i == "C":
                Scorenumber.append(C)

        results.append({
            "name":"tls",
            "score":Scorenumber[0],
            "message":"tls score",
            "description":"Sucuri tls score "+str(Scorenumber[0])
        })
        results.append({
            "name":"total",
            "score":Scorenumber[1],
            "message":"total score",
            "description":"Sucuri total score "+str(Scorenumber[1])
        })
        results.append({
            "name":"domain",
            "score":Scorenumber[2],
            "message":"domain score",
            "description":"Sucuri domain score "+str(Scorenumber[2])
        })
        results.append({
            "name":"security",
            "score":Scorenumber[3],
            "message":"security score",
            "description":"Sucuri security score "+str(Scorenumber[3])
        })
        try:
            warning=responsedr['warnings']
            if  warning:
                results.append({
                  "name":"warning",
                  "score":C,
                  "message":"warning",
                  "description":"Sucuri warning is found "
                })

        except:
            results.append({
                "name":"warning",
                "score":A,
                "message":"warning",
                "description":"Sucuri warning is not found"
            })


if __name__ == "__main__":
  main(sys.argv[1],sys.argv[2])


